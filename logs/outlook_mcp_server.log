2025-10-17 15:39:13,785 | INFO | outlook_mcp_server | Configurazione features caricata da C:\Users\Davide\OneDrive - Sonepar\Documenti\MCP\outlook-mcp-server\features.json (groups on=* off=-, tools on=- off=-)
2025-10-17 15:39:56,267 | INFO | outlook_mcp_server | Configurazione features caricata da C:\Users\Davide\OneDrive - Sonepar\Documenti\MCP\outlook-mcp-server\features.json (groups on=* off=-, tools on=- off=-)
2025-10-17 15:45:12,238 | INFO | outlook_mcp_server | Configurazione features caricata da C:\Users\Davide\OneDrive - Sonepar\Documenti\MCP\outlook-mcp-server\features.json (groups on=* off=-, tools on=- off=-)
2025-10-17 15:46:30,925 | INFO | outlook_mcp_server | Configurazione features caricata da C:\Users\Davide\OneDrive - Sonepar\Documenti\MCP\outlook-mcp-server\features.json (groups on=* off=-, tools on=- off=-)
2025-10-17 15:55:55,292 | INFO | outlook_mcp_server | Configurazione features caricata da C:\Users\Davide\OneDrive - Sonepar\Documenti\MCP\outlook-mcp-server\features.json (groups on=* off=-, tools on=- off=-)
2025-10-17 15:56:12,129 | INFO | outlook_mcp_server | Configurazione features caricata da C:\Users\Davide\OneDrive - Sonepar\Documenti\MCP\outlook-mcp-server\features.json (groups on=* off=-, tools on=- off=-)
2025-10-17 15:58:05,445 | INFO | outlook_mcp_server | Configurazione features caricata da C:\Users\Davide\OneDrive - Sonepar\Documenti\MCP\outlook-mcp-server\features.json (groups on=* off=-, tools on=- off=-)
2025-10-17 15:58:05,588 | INFO | outlook_mcp_server | Outlook MCP Server avviato in modalita mcp.
2025-10-17 15:58:05,600 | INFO | outlook_mcp_server | Verifica della connessione a Outlook in corso.
2025-10-17 15:58:07,307 | INFO | outlook_mcp_server | Connessione a Outlook verificata. La Posta in arrivo contiene 2101 elementi.
2025-10-17 15:58:07,314 | INFO | outlook_mcp_server | Server MCP avviato in modalita streamable-http su http://0.0.0.0:8000/mcp.
2025-10-17 16:01:46,281 | INFO | outlook_mcp_server | Configurazione features caricata da C:\Users\Davide\OneDrive - Sonepar\Documenti\MCP\outlook-mcp-server\features.json (groups on=* off=-, tools on=- off=-)
2025-10-17 16:01:46,601 | INFO | outlook_mcp_server | test_list: restituiti 2 messaggi su 3 (termine=None cartella=Posta in arrivo offset=1).
2025-10-17 16:01:46,605 | INFO | outlook_mcp_server | mark_email_read_unread chiamato (numero=1 id=None unread=False).
2025-10-17 16:01:46,611 | INFO | outlook_mcp_server | get_attachments chiamato (numero=None id=MSG1 download=True limit=None destinazione=C:\Users\Davide\AppData\Local\Temp\pytest-of-Davide\pytest-11\test_get_attachments_download0).
2025-10-17 16:01:46,613 | INFO | outlook_mcp_server | move_email_to_folder chiamato (numero=1 id=None target_id=FOLDER-ID target_path=None target_nome=None crea=False).
2025-10-17 16:01:46,615 | INFO | outlook_mcp_server | create_folder chiamato (nome=Reports parent_id=PID parent_path=None parent_name=None tipo=None allow_existing=False).
2025-10-17 16:01:46,615 | INFO | outlook_mcp_server | delete_folder chiamato (id=DEL-ID path=None nome=None).
2025-10-17 16:01:46,616 | ERROR | outlook_mcp_server | Errore durante delete_folder.
Traceback (most recent call last):
  File "C:\Users\Davide\OneDrive - Sonepar\Documenti\MCP\outlook-mcp-server\outlook_mcp\tools\folders.py", line 231, in delete_folder
    _, namespace = connect_to_outlook()
                   ^^^^^^^^^^^^^^^^^^
NameError: name 'connect_to_outlook' is not defined
2025-10-17 16:01:46,717 | INFO | outlook_mcp_server | compose_email chiamato (destinatario=dest@example.com cc=None bcc=None oggetto='HTML Test' invia=True allegati=[] html=True).
2025-10-17 16:01:46,720 | INFO | outlook_mcp_server | search_contacts chiamato (termine=None max_results=50).
2025-10-17 16:01:46,720 | INFO | outlook_mcp_server | search_contacts chiamato (termine=Acme max_results=50).
2025-10-17 16:01:46,721 | INFO | outlook_mcp_server | search_contacts chiamato (termine=None max_results=50).
2025-10-17 16:01:46,722 | INFO | outlook_mcp_server | search_contacts chiamato (termine=None max_results=50).
2025-10-17 16:01:46,752 | INFO | outlook_mcp_server | list_pending_replies chiamato con giorni=14 cartella=None max_risultati=25 anteprima=True tutte_le_cartelle=False solo_non_letti=False lookback_conv=28
2025-10-17 16:01:46,753 | ERROR | outlook_mcp_server | Errore durante list_pending_replies per la cartella 'Posta in arrivo'.
Traceback (most recent call last):
  File "C:\Users\Davide\OneDrive - Sonepar\Documenti\MCP\outlook-mcp-server\outlook_mcp\tools\email_list.py", line 376, in list_pending_replies
    _, namespace = connect_to_outlook()
                   ^^^^^^^^^^^^^^^^^^
NameError: name 'connect_to_outlook' is not defined
2025-10-17 16:04:21,962 | INFO | outlook_mcp_server | Configurazione features caricata da C:\Users\Davide\OneDrive - Sonepar\Documenti\MCP\outlook-mcp-server\features.json (groups on=* off=-, tools on=- off=-)
2025-10-17 16:05:48,188 | INFO | outlook_mcp_server | Configurazione features caricata da C:\Users\Davide\OneDrive - Sonepar\Documenti\MCP\outlook-mcp-server\features.json (groups on=* off=-, tools on=- off=-)
2025-10-17 16:06:05,225 | INFO | outlook_mcp_server | Configurazione features caricata da C:\Users\Davide\OneDrive - Sonepar\Documenti\MCP\outlook-mcp-server\features.json (groups on=* off=-, tools on=- off=-)
2025-10-17 16:06:05,539 | INFO | outlook_mcp_server | test_list: restituiti 2 messaggi su 3 (termine=None cartella=Posta in arrivo offset=1).
2025-10-17 16:06:05,542 | INFO | outlook_mcp_server | mark_email_read_unread chiamato (numero=1 id=None unread=False).
2025-10-17 16:06:05,550 | INFO | outlook_mcp_server | get_attachments chiamato (numero=None id=MSG1 download=True limit=None destinazione=C:\Users\Davide\AppData\Local\Temp\pytest-of-Davide\pytest-13\test_get_attachments_download0).
2025-10-17 16:06:05,552 | INFO | outlook_mcp_server | move_email_to_folder chiamato (numero=1 id=None target_id=FOLDER-ID target_path=None target_nome=None crea=False).
2025-10-17 16:06:05,558 | INFO | outlook_mcp_server | create_folder chiamato (nome=Reports parent_id=PID parent_path=None parent_name=None tipo=None allow_existing=False).
2025-10-17 16:06:05,558 | ERROR | outlook_mcp_server | Errore durante create_folder.
Traceback (most recent call last):
  File "C:\Users\Davide\OneDrive - Sonepar\Documenti\MCP\outlook-mcp-server\outlook_mcp\tools\folders.py", line 139, in create_folder
    _, namespace = _connect()
                   ~~~~~~~~^^
  File "C:\Users\Davide\OneDrive - Sonepar\Documenti\MCP\outlook-mcp-server\outlook_mcp\tools\folders.py", line 16, in _connect
    return _connect()
  File "C:\Users\Davide\OneDrive - Sonepar\Documenti\MCP\outlook-mcp-server\outlook_mcp\tools\folders.py", line 16, in _connect
    return _connect()
  File "C:\Users\Davide\OneDrive - Sonepar\Documenti\MCP\outlook-mcp-server\outlook_mcp\tools\folders.py", line 16, in _connect
    return _connect()
  [Previous line repeated 961 more times]
RecursionError: maximum recursion depth exceeded
2025-10-17 16:06:05,653 | INFO | outlook_mcp_server | delete_folder chiamato (id=DEL-ID path=None nome=None).
2025-10-17 16:06:05,654 | ERROR | outlook_mcp_server | Errore durante delete_folder.
Traceback (most recent call last):
  File "C:\Users\Davide\OneDrive - Sonepar\Documenti\MCP\outlook-mcp-server\outlook_mcp\tools\folders.py", line 231, in delete_folder
    _, namespace = _connect()
                   ~~~~~~~~^^
  File "C:\Users\Davide\OneDrive - Sonepar\Documenti\MCP\outlook-mcp-server\outlook_mcp\tools\folders.py", line 16, in _connect
    return _connect()
  File "C:\Users\Davide\OneDrive - Sonepar\Documenti\MCP\outlook-mcp-server\outlook_mcp\tools\folders.py", line 16, in _connect
    return _connect()
  File "C:\Users\Davide\OneDrive - Sonepar\Documenti\MCP\outlook-mcp-server\outlook_mcp\tools\folders.py", line 16, in _connect
    return _connect()
  [Previous line repeated 961 more times]
RecursionError: maximum recursion depth exceeded
2025-10-17 16:06:05,691 | INFO | outlook_mcp_server | compose_email chiamato (destinatario=dest@example.com cc=None bcc=None oggetto='HTML Test' invia=True allegati=[] html=True).
2025-10-17 16:06:05,694 | INFO | outlook_mcp_server | search_contacts chiamato (termine=None max_results=50).
2025-10-17 16:06:05,694 | INFO | outlook_mcp_server | search_contacts chiamato (termine=Acme max_results=50).
2025-10-17 16:06:05,695 | INFO | outlook_mcp_server | search_contacts chiamato (termine=None max_results=50).
2025-10-17 16:06:05,696 | INFO | outlook_mcp_server | search_contacts chiamato (termine=None max_results=50).
2025-10-17 16:06:05,732 | INFO | outlook_mcp_server | list_pending_replies chiamato con giorni=14 cartella=None max_risultati=25 anteprima=True tutte_le_cartelle=False solo_non_letti=False lookback_conv=28
2025-10-17 16:06:05,734 | ERROR | outlook_mcp_server | Errore durante list_pending_replies per la cartella 'Posta in arrivo'.
Traceback (most recent call last):
  File "C:\Users\Davide\OneDrive - Sonepar\Documenti\MCP\outlook-mcp-server\outlook_mcp\tools\email_list.py", line 376, in list_pending_replies
    _, namespace = _connect()
                   ~~~~~~~~^^
  File "C:\Users\Davide\OneDrive - Sonepar\Documenti\MCP\outlook-mcp-server\outlook_mcp\tools\email_list.py", line 34, in _connect
    return _connect()
  File "C:\Users\Davide\OneDrive - Sonepar\Documenti\MCP\outlook-mcp-server\outlook_mcp\tools\email_list.py", line 34, in _connect
    return _connect()
  File "C:\Users\Davide\OneDrive - Sonepar\Documenti\MCP\outlook-mcp-server\outlook_mcp\tools\email_list.py", line 34, in _connect
    return _connect()
  [Previous line repeated 961 more times]
RecursionError: maximum recursion depth exceeded
2025-10-17 16:06:27,324 | INFO | outlook_mcp_server | Configurazione features caricata da C:\Users\Davide\OneDrive - Sonepar\Documenti\MCP\outlook-mcp-server\features.json (groups on=* off=-, tools on=- off=-)
2025-10-17 16:06:58,298 | INFO | outlook_mcp_server | Configurazione features caricata da C:\Users\Davide\OneDrive - Sonepar\Documenti\MCP\outlook-mcp-server\features.json (groups on=* off=-, tools on=- off=-)
2025-10-17 16:06:58,619 | INFO | outlook_mcp_server | test_list: restituiti 2 messaggi su 3 (termine=None cartella=Posta in arrivo offset=1).
2025-10-17 16:06:58,622 | INFO | outlook_mcp_server | mark_email_read_unread chiamato (numero=1 id=None unread=False).
2025-10-17 16:06:58,629 | INFO | outlook_mcp_server | get_attachments chiamato (numero=None id=MSG1 download=True limit=None destinazione=C:\Users\Davide\AppData\Local\Temp\pytest-of-Davide\pytest-14\test_get_attachments_download0).
2025-10-17 16:06:58,632 | INFO | outlook_mcp_server | move_email_to_folder chiamato (numero=1 id=None target_id=FOLDER-ID target_path=None target_nome=None crea=False).
2025-10-17 16:06:58,639 | INFO | outlook_mcp_server | create_folder chiamato (nome=Reports parent_id=PID parent_path=None parent_name=None tipo=None allow_existing=False).
2025-10-17 16:06:58,641 | INFO | outlook_mcp_server | delete_folder chiamato (id=DEL-ID path=None nome=None).
2025-10-17 16:06:58,642 | INFO | outlook_mcp_server | compose_email chiamato (destinatario=dest@example.com cc=None bcc=None oggetto='HTML Test' invia=True allegati=[] html=True).
2025-10-17 16:06:58,644 | INFO | outlook_mcp_server | search_contacts chiamato (termine=None max_results=50).
2025-10-17 16:06:58,644 | INFO | outlook_mcp_server | search_contacts chiamato (termine=Acme max_results=50).
2025-10-17 16:06:58,646 | INFO | outlook_mcp_server | search_contacts chiamato (termine=None max_results=50).
2025-10-17 16:06:58,647 | INFO | outlook_mcp_server | search_contacts chiamato (termine=None max_results=50).
2025-10-17 16:06:58,649 | INFO | outlook_mcp_server | create_calendar_event chiamato (subject=Riunione settimanale  start=2025-10-20 10:30 durata=90 luogo=Sala Riunioni partecipanti=['alice@example.com', 'bob@example.com'] all_day=False invia=True calendario=None).
2025-10-17 16:06:58,650 | INFO | outlook_mcp_server | create_calendar_event chiamato (subject=Giornata intera start=2025-12-24 15:30 durata=None luogo=None partecipanti=[] all_day=True invia=True calendario=None).
2025-10-17 16:06:58,675 | INFO | outlook_mcp_server | create_calendar_event chiamato (subject=Evento start=2025-11-01 durata=60 luogo=None partecipanti=[] all_day=False invia=True calendario=Agenda condivisa).
2025-10-17 16:06:58,684 | INFO | outlook_mcp_server | list_pending_replies chiamato con giorni=14 cartella=None max_risultati=25 anteprima=True tutte_le_cartelle=False solo_non_letti=False lookback_conv=28
2025-10-17 16:06:58,684 | INFO | outlook_mcp_server | list_pending_replies ha trovato 2 messaggi da gestire su 2 analizzati.
2025-10-17 16:06:58,684 | INFO | outlook_mcp_server | list_pending_replies: restituiti 2 messaggi su 2 (termine=None cartella=Posta in arrivo (senza risposta) offset=0).
2025-10-17 16:08:33,247 | INFO | outlook_mcp_server | Configurazione features caricata da C:\Users\Davide\OneDrive - Sonepar\Documenti\MCP\outlook-mcp-server\features.json (groups on=* off=-, tools on=- off=-)
2025-10-17 16:08:33,452 | INFO | outlook_mcp_server | create_folder chiamato (nome=MCPINT_20251017_160833_Base parent_id=0000000057ED66F88E5F0346B882295244EEE2EA0100B12F2EC9C1542243BEEFD9D2C078D1B200000000010C0000 parent_path=None parent_name=None tipo=None allow_existing=False).
2025-10-17 16:08:33,469 | INFO | outlook_mcp_server | rename_folder chiamato (id=None path=None nome=MCPINT_20251017_160833_Base nuovo_nome=MCPINT_20251017_160833_Base_Renamed).
2025-10-17 16:08:33,486 | INFO | outlook_mcp_server | create_folder chiamato (nome=MCPINT_20251017_160833_Move parent_id=0000000057ED66F88E5F0346B882295244EEE2EA0100B12F2EC9C1542243BEEFD9D2C078D1B200000000010C0000 parent_path=None parent_name=None tipo=None allow_existing=True).
2025-10-17 16:08:33,513 | INFO | outlook_mcp_server | compose_email chiamato (destinatario=davide.marchetto@sacchi.it cc=None bcc=None oggetto='MCPINT_20251017_160833 Subject' invia=False allegati=[] html=True).
2025-10-17 16:08:33,536 | INFO | outlook_mcp_server | move_email_to_folder chiamato (numero=None id=0000000057ED66F88E5F0346B882295244EEE2EA0700B12F2EC9C1542243BEEFD9D2C078D1B200000000010F0000B12F2EC9C1542243BEEFD9D2C078D1B20000847DEBA50000 target_id=None target_path=\\davide.marchetto@sacchi.it\Posta in arrivo\MCPINT_20251017_160833_Move target_nome=None crea=False).
2025-10-17 16:08:33,579 | INFO | outlook_mcp_server | move_email_to_folder chiamato (numero=None id=0000000057ED66F88E5F0346B882295244EEE2EA0700B12F2EC9C1542243BEEFD9D2C078D1B20000847E62920000B12F2EC9C1542243BEEFD9D2C078D1B20000847E70030000 target_id=None target_path=\\davide.marchetto@sacchi.it\Bozze target_nome=None crea=False).
2025-10-17 16:08:33,618 | INFO | outlook_mcp_server | attach_to_email chiamato (numero=None id=0000000057ED66F88E5F0346B882295244EEE2EA0700B12F2EC9C1542243BEEFD9D2C078D1B200000000010F0000B12F2EC9C1542243BEEFD9D2C078D1B20000847DEBA60000 allegati=['C:\\Users\\Davide\\AppData\\Local\\Temp\\pytest-of-Davide\\pytest-15\\test_real_outlook_end_to_end0\\mcp_integration_attachment.txt'] invia=False).
2025-10-17 16:08:33,703 | INFO | outlook_mcp_server | get_attachments chiamato (numero=None id=0000000057ED66F88E5F0346B882295244EEE2EA0700B12F2EC9C1542243BEEFD9D2C078D1B200000000010F0000B12F2EC9C1542243BEEFD9D2C078D1B20000847DEBA60000 download=True limit=None destinazione=C:\Users\Davide\AppData\Local\Temp\pytest-of-Davide\pytest-15\test_real_outlook_end_to_end0\downloads).
2025-10-17 16:08:33,739 | INFO | outlook_mcp_server | search_contacts chiamato (termine=MCPINT_20251017_160833 max_results=50).
2025-10-17 16:08:35,178 | INFO | outlook_mcp_server | create_calendar_event chiamato (subject=MCPINT_20251017_160833 Meeting start=2025-10-17 17:00 durata=45 luogo=Sala Test MCP partecipanti=[] all_day=False invia=False calendario=None).
2025-10-17 16:08:35,368 | INFO | outlook_mcp_server | batch_manage_emails chiamato (numeri=[] ids=['0000000057ED66F88E5F0346B882295244EEE2EA0700B12F2EC9C1542243BEEFD9D2C078D1B200000000010F0000B12F2EC9C1542243BEEFD9D2C078D1B20000847DEBA60000'] move=False mark=None delete=True).
2025-10-17 16:08:35,409 | INFO | outlook_mcp_server | delete_folder chiamato (id=None path=None nome=MCPINT_20251017_160833_Base_Renamed).
2025-10-17 16:08:35,424 | INFO | outlook_mcp_server | delete_folder chiamato (id=None path=None nome=MCPINT_20251017_160833_Base).
2025-10-17 16:08:36,469 | INFO | outlook_mcp_server | delete_folder chiamato (id=None path=None nome=MCPINT_20251017_160833_Move).
2025-10-17 16:10:10,157 | INFO | outlook_mcp_server | Configurazione features caricata da C:\Users\Davide\OneDrive - Sonepar\Documenti\MCP\outlook-mcp-server\features.json (groups on=* off=-, tools on=- off=-)
2025-10-17 16:10:10,304 | INFO | outlook_mcp_server | Outlook MCP Server avviato in modalita mcp.
2025-10-17 16:10:10,308 | INFO | outlook_mcp_server | Verifica della connessione a Outlook in corso.
2025-10-17 16:10:10,324 | INFO | outlook_mcp_server | Connessione a Outlook verificata. La Posta in arrivo contiene 2098 elementi.
2025-10-17 16:10:10,327 | INFO | outlook_mcp_server | Server MCP avviato in modalita streamable-http su http://0.0.0.0:8000/mcp.
2025-10-17 16:10:36,947 | INFO | outlook_mcp_server | Configurazione features caricata da C:\Users\Davide\OneDrive - Sonepar\Documenti\MCP\outlook-mcp-server\features.json (groups on=* off=-, tools on=- off=-)
2025-10-17 16:10:37,258 | INFO | outlook_mcp_server | test_list: restituiti 2 messaggi su 3 (termine=None cartella=Posta in arrivo offset=1).
2025-10-17 16:10:37,261 | INFO | outlook_mcp_server | mark_email_read_unread chiamato (numero=1 id=None unread=False).
2025-10-17 16:10:37,277 | INFO | outlook_mcp_server | get_attachments chiamato (numero=None id=MSG1 download=True limit=None destinazione=C:\Users\Davide\AppData\Local\Temp\pytest-of-Davide\pytest-16\test_get_attachments_download0).
2025-10-17 16:10:37,280 | INFO | outlook_mcp_server | move_email_to_folder chiamato (numero=1 id=None target_id=FOLDER-ID target_path=None target_nome=None crea=False).
2025-10-17 16:10:37,282 | INFO | outlook_mcp_server | create_folder chiamato (nome=Reports parent_id=PID parent_path=None parent_name=None tipo=None allow_existing=False).
2025-10-17 16:10:37,283 | INFO | outlook_mcp_server | delete_folder chiamato (id=DEL-ID path=None nome=None).
2025-10-17 16:10:37,284 | INFO | outlook_mcp_server | compose_email chiamato (destinatario=dest@example.com cc=None bcc=None oggetto='HTML Test' invia=True allegati=[] html=True).
2025-10-17 16:10:37,285 | INFO | outlook_mcp_server | search_contacts chiamato (termine=None max_results=50).
2025-10-17 16:10:37,286 | INFO | outlook_mcp_server | search_contacts chiamato (termine=Acme max_results=50).
2025-10-17 16:10:37,287 | INFO | outlook_mcp_server | search_contacts chiamato (termine=None max_results=50).
2025-10-17 16:10:37,288 | INFO | outlook_mcp_server | search_contacts chiamato (termine=None max_results=50).
2025-10-17 16:10:37,290 | INFO | outlook_mcp_server | create_calendar_event chiamato (subject=Riunione settimanale  start=2025-10-20 10:30 durata=90 luogo=Sala Riunioni partecipanti=['alice@example.com', 'bob@example.com'] all_day=False invia=True calendario=None).
2025-10-17 16:10:37,291 | INFO | outlook_mcp_server | create_calendar_event chiamato (subject=Giornata intera start=2025-12-24 15:30 durata=None luogo=None partecipanti=[] all_day=True invia=True calendario=None).
2025-10-17 16:10:37,312 | INFO | outlook_mcp_server | create_calendar_event chiamato (subject=Evento start=2025-11-01 durata=60 luogo=None partecipanti=[] all_day=False invia=True calendario=Agenda condivisa).
2025-10-17 16:10:37,314 | INFO | outlook_mcp_server | list_pending_replies chiamato con giorni=14 cartella=None max_risultati=25 anteprima=True tutte_le_cartelle=False solo_non_letti=False lookback_conv=28
2025-10-17 16:10:37,315 | INFO | outlook_mcp_server | list_pending_replies ha trovato 2 messaggi da gestire su 2 analizzati.
2025-10-17 16:10:37,315 | INFO | outlook_mcp_server | list_pending_replies: restituiti 2 messaggi su 2 (termine=None cartella=Posta in arrivo (senza risposta) offset=0).
